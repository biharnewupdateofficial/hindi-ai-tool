<!DOCTYPE html>
<html>
<head>
    <title>OpenTutor AI</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body class="dark">

<div class="app">
    <div class="header">
        ğŸ¤– OpenTutor AI
        <div class="top-actions">
            <button onclick="toggleMode()">ğŸŒ—</button>
            <a href="/logout">Logout</a>
        </div>
    </div>

    <!-- Suggestions -->
    <div class="suggestions">
        <button onclick="quick('Class 10 ka quadratic equation samjhao')">ğŸ“˜ Math</button>
        <button onclick="quick('Bihar ke baare me batao')">ğŸŒ Bihar</button>
        <button onclick="quick('Resume bana do')">ğŸ“„ Resume</button>
        <button onclick="quick('Ek sher ki image banao')">ğŸ–¼ï¸ Image</button>
    </div>

    <!-- Chat -->
    <div class="chat-box" id="chat">
        {% for c in chats %}
            <div class="msg {{ c.role }}">{{ c.message }}</div>
        {% endfor %}
    </div>

    <!-- Input -->
    <div class="input-area">
        <button onclick="startMic()">ğŸ¤</button>
        <textarea id="q" placeholder="Apna sawal likhiye..."></textarea>
        <button onclick="send()">Send</button>
    </div>
</div>

<script>
function send(){
    let q = document.getElementById("q");
    if(!q.value.trim()) return;

    fetch("/ask",{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({question:q.value})
    }).then(()=>location.reload());
}

function quick(text){
    document.getElementById("q").value = text;
    send();
}

/* ğŸ¤ Voice to Text */
function startMic(){
    const rec = new(window.SpeechRecognition || window.webkitSpeechRecognition)();
    rec.lang = "hi-IN";
    rec.onresult = e => {
        document.getElementById("q").value = e.results[0][0].transcript;
    };
    rec.start();
}

/* ğŸŒ— Dark / Light */
function toggleMode(){
    document.body.classList.toggle("light");
}

/* âš¡ Typing Effect (basic) */
document.querySelectorAll(".ai").forEach(el=>{
    let text = el.innerText;
    el.innerText = "";
    let i = 0;
    let t = setInterval(()=>{
        el.innerText += text[i++];
        if(i >= text.length) clearInterval(t);
    },15);
});
</script>

</body>
</html>
