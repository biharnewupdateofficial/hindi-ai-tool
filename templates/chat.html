<!DOCTYPE html>
<html>
<head>
<title>OpenTutor AI</title>
</head>
<body>

<div id="top"></div>

<div id="chat"></div>
<textarea id="q"></textarea>
<button onclick="send()">Send</button>

<script>
function loadStatus(){
    fetch("/status").then(r=>r.json()).then(d=>{
        document.getElementById("top").innerHTML=
        `Plan: <b>${d.plan}</b> | Messages left: <b>${d.left}</b>
         ${d.plan==="free" ? '<a href="/upgrade">Upgrade</a>':''}`;
    });
}
loadStatus();

function send(){
    let q=document.getElementById("q").value;
    document.getElementById("chat").innerHTML+=`<p>You: ${q}</p>`;
    document.getElementById("q").value="";
    fetch("/ask",{method:"POST",headers:{'Content-Type':'application/json'},
    body:JSON.stringify({question:q})})
    .then(r=>r.json()).then(d=>{
        document.getElementById("chat").innerHTML+=`<p>AI: ${d.answer}</p>`;
        loadStatus();
    });
}
</script>

</body>
</html>
