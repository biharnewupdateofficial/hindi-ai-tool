<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>OpenTutor AI</title>

<style>
:root {
    --bg: #f5f5f5;
    --card: #ffffff;
    --text: #000;
    --user: #2563eb;
    --ai: #e5e7eb;
}

.dark {
    --bg: #0f172a;
    --card: #1e293b;
    --text: #f1f5f9;
    --user: #3b82f6;
    --ai: #334155;
}

* { box-sizing: border-box; font-family: Arial, sans-serif; }

body {
    margin: 0;
    background: var(--bg);
    color: var(--text);
}

.app {
    display: flex;
    height: 100vh;
}

/* Sidebar */
.sidebar {
    width: 260px;
    background: var(--card);
    padding: 15px;
    border-right: 1px solid #444;
}

.sidebar h2 {
    margin-top: 0;
}

.sidebar button {
    width: 100%;
    padding: 10px;
    margin-bottom: 10px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
}

.newchat { background:#22c55e; color:white; }
.toggle { background:#6366f1; color:white; }
.logout { background:#ef4444; color:white; }

/* Chat */
.chat-area {
    flex: 1;
    display: flex;
    flex-direction: column;
}

.chat-header {
    padding: 15px;
    background: var(--card);
    border-bottom: 1px solid #444;
    font-weight: bold;
}

.chat-box {
    flex: 1;
    padding: 20px;
    overflow-y: auto;
}

.user {
    background: var(--user);
    color: white;
    padding: 10px 14px;
    border-radius: 12px;
    margin: 8px 0;
    max-width: 70%;
    margin-left: auto;
}

.ai {
    background: var(--ai);
    padding: 10px 14px;
    border-radius: 12px;
    margin: 8px 0;
    max-width: 70%;
}

/* Input */
.input-area {
    display: flex;
    padding: 15px;
    background: var(--card);
}

textarea {
    flex: 1;
    resize: none;
    padding: 10px;
    border-radius: 8px;
    border: none;
}

.send {
    margin-left: 10px;
    padding: 0 20px;
    border: none;
    border-radius: 8px;
    background: #22c55e;
    color: white;
}
</style>
</head>

<body>

<div class="app">

<div class="sidebar">
    <h2>ðŸ¤– OpenTutor AI</h2>
    <button class="newchat" onclick="newChat()">âž• New Chat</button>
    <button class="toggle" onclick="toggleMode()">ðŸŒ— Dark / Light</button>
    <button class="logout" onclick="location.href='/logout'">ðŸšª Logout</button>
</div>

<div class="chat-area">
    <div class="chat-header">ChatGPT + Gemini Mode</div>
    <div id="chatBox" class="chat-box"></div>

    <div class="input-area">
        <textarea id="q" placeholder="Type your message..."></textarea>
        <button class="send" onclick="send()">Send</button>
    </div>
</div>

</div>

<script>
const chatBox = document.getElementById("chatBox");
const body = document.body;

// Load theme
if(localStorage.getItem("theme")==="dark"){
    body.classList.add("dark");
}

function toggleMode(){
    body.classList.toggle("dark");
    localStorage.setItem("theme", body.classList.contains("dark") ? "dark":"light");
}

function addMsg(text, cls){
    let d=document.createElement("div");
    d.className=cls;
    d.innerText=text;
    chatBox.appendChild(d);
    chatBox.scrollTop=chatBox.scrollHeight;
}

function send(){
    let q=document.getElementById("q").value.trim();
    if(!q) return;
    addMsg(q,"user");
    document.getElementById("q").value="";

    fetch("/ask",{
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body:JSON.stringify({question:q})
    })
    .then(r=>r.json())
    .then(d=>addMsg(d.answer,"ai"));
}

function newChat(){
    chatBox.innerHTML="";
}
</script>

</body>
</html>
