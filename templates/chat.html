<!DOCTYPE html>
<html>
<head>
<title>OpenTutor AI</title>
<link rel="stylesheet" href="/static/style.css">
</head>
<body class="dark">

<header>
  <h2>ðŸ¤– OpenTutor AI</h2>
  <div class="modes">
    <span>ChatGPT</span>
    <span>Gemini</span>
  </div>
</header>

<div id="chat">
  {% for m in messages %}
    <div class="{{ m.role }}">{{ m.text }}</div>
  {% endfor %}
</div>

<div class="input">
  <textarea id="q" placeholder="Type or Speak..."></textarea>
  <button onclick="startVoice()">ðŸŽ™</button>
  <button onclick="send()">Send</button>
</div>

<script>
function send(){
  let q=document.getElementById("q").value;
  if(!q) return;
  fetch("/ask",{method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({question:q})
  }).then(()=>location.reload());
}

function startVoice(){
  if(!('webkitSpeechRecognition' in window)){
    alert("Voice not supported");
    return;
  }
  let rec = new webkitSpeechRecognition();
  rec.lang="hi-IN";
  rec.onresult = e=>{
    document.getElementById("q").value = e.results[0][0].transcript;
  };
  rec.start();
}
</script>

</body>
</html>
